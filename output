he query has been running for 8 minutes 45 seconds and hasn't completed. Only 5 out of 7 snippets have executed.
Executed Snippets

Snippet 1: 0.031s ✓
Snippet 2: 2.625s ✓ (slowest so far)
Snippet 3: 0.439s ✓
Snippet 4: 0.286s ✓
Snippet 5: 0.349s ✓
Snippets 6 & 7: NOT executed yet

The Problem: Cartesian Explosion
Looking at snippet 6's join conditions, I can see the issue:
6[04]: spu HashJoinNode
-- Cost=5384.5..2274901.3 Rows=164.7T Width=47 Size=Infinity Conf=64
This join is estimating 164.7 TRILLION rows (note the "T"), which is clearly wrong. This happens again at:
6[10]: spu HashJoinNode
-- Cost=21260.6..2866039340340.8 Rows=Infinity Width=8 Size=Infinity Conf=26
The confidence levels (64% and 26%) are very low, indicating the optimizer doesn't have good statistics.
Root Cause
Your query is joining:

PORTFOLIO_DETAIL_LOANHUB (HUB) - 79.6M rows
V_PORTFOLIO_DETAIL_CECL_D (CECL) - which is a VIEW containing joins of 3 tables totaling ~128M rows each

The view expands to:

PORTFOLIO_DETAIL_PK_D (128M rows)
PORTFOLIO_DETAIL_STANDARDIZED_D (128M rows)
PORTFOLIO_DETAIL_INDICATOR_D (128M rows)

Notice the statistics warning: "outdated" for all three CECL tables.
Why It's Stuck
Snippet 6 is trying to perform multiple hash joins across these massive redistributed tables, and the plan shows it's creating a cartesian product due to poor join selectivity.
Recommendations
1. Update Statistics (Critical)
sqlGENERATE STATISTICS ON FCBCECL.PORTFOLIO_DETAIL_PK_D;
GENERATE STATISTICS ON FCBCECL.PORTFOLIO_DETAIL_STANDARDIZED_D;
GENERATE STATISTICS ON FCBCECL.PORTFOLIO_DETAIL_INDICATOR_D;
2. Check the View Definition
sql-- What is V_PORTFOLIO_DETAIL_CECL_D actually doing?
\d FCBCECL.V_PORTFOLIO_DETAIL_CECL_D
The view likely has missing or incorrect join conditions causing the cartesian product.
3. Distribution Key Mismatch
Your tables are distributed on different keys:

HUB: distributed on ACCOUNT_KEY
CECL tables: distributed on PRIMARY_KEY or ACCOUNT_KEY

This causes data redistribution (see the DownloadTableNode operations), which is expensive.
4. Immediate Action
Kill this query - it won't complete in any reasonable timeframe:
sql-- Find the session
SELECT * FROM _V_QRYSTAT WHERE PLANID = 2672964;

-- Abort it
ABORT SESSION <session_id>;
5. Alternative Approach
Instead of using the view, try joining the base tables directly with explicit join conditions to avoid the cartesian product. Or add a filter on the CECL side before joining:
sqlSELECT HUB.*
FROM FCBAPP.PORTFOLIO_DETAIL_LOANHUB HUB
LEFT JOIN (
    SELECT DISTINCT ACCOUNT_KEY, DATE_KEY
    FROM FCBCECL.V_PORTFOLIO_DETAIL_CECL_D
    WHERE END_OF_MONTH_DATE = '2025-12-31'
) CECL
    ON CECL.ACCOUNT_KEY = HUB.ACCOUNT_KEY
    AND CECL.DATE_KEY = HUB.DATE_KEY
WHERE HUB.END_OF_MONTH_DATE = '2025-12-31'
Would you like me to help analyze the view definition or create an optimized alternative query?
